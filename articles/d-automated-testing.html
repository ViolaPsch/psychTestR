<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial (intermediate): Automated testing • psychTestR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial (intermediate): Automated testing">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psychTestR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.19.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1-simple-demo.html">Demos</a>
    </li>
    <li>
      <a href="../articles/a2-research-examples.html">Research examples</a>
    </li>
    <li>
      <a href="../articles/b-introduction.html">An introduction to psychTestR</a>
    </li>
    <li>
      <a href="../articles/c-media-files.html">Tutorial (basic): Media files</a>
    </li>
    <li>
      <a href="../articles/c-modularisation.html">Tutorial (basic): Modularisation</a>
    </li>
    <li>
      <a href="../articles/d-automated-testing.html">Tutorial (intermediate): Automated testing</a>
    </li>
    <li>
      <a href="../articles/d-building-custom-page-types.html">Tutorial (intermediate): Building custom page types</a>
    </li>
    <li>
      <a href="../articles/d-editing-dictionaries.html">Tutorial (intermediate): Editing dictionaries</a>
    </li>
    <li>
      <a href="../articles/d-hosting-experiments-online.html">Tutorial (intermediate): Hosting experiments online</a>
    </li>
    <li>
      <a href="../articles/d-randomisation.html">Tutorial (intermediate): Randomising item administration</a>
    </li>
    <li>
      <a href="../articles/d-url-parameters.html">Tutorial (intermediate): URL parameters</a>
    </li>
    <li>
      <a href="../articles/e-internationalised-questionnaire.html">Tutorial (expert): Creating an internationalised questionnaire</a>
    </li>
    <li>
      <a href="../articles/e-jspsych-integration.html">Tutorial (expert): jsPsych integration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pmcharrison/psychTestR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial (intermediate): Automated testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pmcharrison/psychTestR/blob/master/vignettes/d-automated-testing.Rmd"><code>vignettes/d-automated-testing.Rmd</code></a></small>
      <div class="hidden name"><code>d-automated-testing.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Automated testing is essential in modern software development. In the context of psychological experiment development, automated tests help you to ensure the robustness of your experiment’s implementation without having to invest tedious hours in manual testing.</p>
<p>To construct an automated test in psychTestR, you first need a test implementation saved in a file named <code>app.R</code>. Suppose we’ve implemented the following minimal example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(psychTestR)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">display_number &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Page"</span>, i))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">timeline &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join.html">join</a></span>(</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, display_number),</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="kw"><a href="../reference/final_page.html">final_page</a></span>(<span class="st">"End."</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/make_test.html">make_test</a></span>(timeline, <span class="dt">opt =</span> <span class="kw"><a href="../reference/test_options.html">test_options</a></span>(<span class="st">"Minimal test"</span>, <span class="st">"password"</span>))</a></code></pre></div>
<p>Now make a new file, called <code>test.R</code> (or whatever you want). Within this file, we construct an automated tester using the <code>AppTester</code> class:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(psychTestR)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"demos/minimal-test"</span>, <span class="dt">package =</span> <span class="st">"psychTestR"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">app &lt;-<span class="st"> </span>AppTester<span class="op">$</span><span class="kw">new</span>(dir)</a></code></pre></div>
<p>We’ve put a sample <code>app.R</code> file in the psychTestR package, an the above example finds that file using <code>system.file</code>; to point the code to your own <code>app.R</code> file, simply replace the <code>system.file</code> call with the path to the directory containing your <code>app.R</code> file.</p>
<p>This <code>AppTester</code> object instantiates a headless browser which then navigates your psychTestR test, just like a real participant. This object has various methods that are useful for interacting with the psychTestR test and probing its internal state. For example, we can probe the current UI text:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">app<span class="op">$</span><span class="kw">get_ui_text</span>()</a></code></pre></div>
<pre><code>## [1] "Page 1 Next"</code></pre>
<p>We can click the “Next” button:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">app<span class="op">$</span><span class="kw">get_ui_text</span>()</a></code></pre></div>
<pre><code>## [1] "Page 2 Next"</code></pre>
<p>We can pull local variables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">app<span class="op">$</span><span class="kw">get_locals</span>()</a></code></pre></div>
<pre><code>## $.module
## NULL
## 
## $.results_label
## [1] "results"</code></pre>
<p>We can run assertions that throw an error if a given condition is not satisfied:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"Page 2 Next"</span>)</a></code></pre></div>
<p>And we can combine all of this together into an automated script that checks that our test runs as expected:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(testthat) <span class="co"># for the expect_equal function</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">app &lt;-<span class="st"> </span>AppTester<span class="op">$</span><span class="kw">new</span>(dir)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">app<span class="op">$</span><span class="kw">expect_title</span>(<span class="st">"Minimal test"</span>) <span class="co"># check the test's title</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  app<span class="op">$</span><span class="kw">get_locals</span>(),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">  <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">       <span class="dt">.results_label =</span> <span class="st">"results"</span>)</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"Page %i Next"</span>, i))</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18">app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"End."</span>)</a>
<a class="sourceLine" id="cb10-19" data-line-number="19"></a>
<a class="sourceLine" id="cb10-20" data-line-number="20">app<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>() <span class="co"># shuts down the testing process</span></a></code></pre></div>
<p>See <code><a href="../reference/AppTester.html">?AppTester</a></code> for more information on automated testing utilities.</p>
</div>
<div id="a-real-world-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-real-world-example" class="anchor"></a>A real-world example</h2>
<p>The above example was rather simple, but automated testing comes into its own with more complex implementations. Here is an example from the test suite in the psychTestR package, designed to check that nested modules work as intended.</p>
<div id="the-app-tester" class="section level3">
<h3 class="hasAnchor">
<a href="#the-app-tester" class="anchor"></a>The app tester</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/context.html">context</a></span>(<span class="st">"test_modules"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/test_that.html">test_that</a></span>(<span class="st">"main"</span>, {</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  app &lt;-<span class="st"> </span>AppTester<span class="op">$</span><span class="kw">new</span>(<span class="st">"apps/modules"</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We begin in the global environment. Next"</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  app<span class="op">$</span><span class="kw">get_locals</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                                         <span class="dt">.results_label =</span> <span class="st">"results"</span>))</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We've now entered the parent environment. Next"</span>)</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">  app<span class="op">$</span><span class="kw">get_locals</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="st">"parent"</span>,</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">                                         <span class="dt">.results_label =</span> <span class="st">"parent"</span>))</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"In the parent environment, we define a local variable, x = 42. Next"</span>)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  app<span class="op">$</span><span class="kw">get_locals</span>()<span class="op">$</span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"></a>
<a class="sourceLine" id="cb11-19" data-line-number="19">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"Now we enter the child environment. Next"</span>)</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  app<span class="op">$</span><span class="kw">get_locals</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="st">"child"</span>,</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">                                         <span class="dt">.results_label =</span> <span class="st">"parent.child"</span>))</a>
<a class="sourceLine" id="cb11-23" data-line-number="23"></a>
<a class="sourceLine" id="cb11-24" data-line-number="24">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-25" data-line-number="25">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We can't see x any more: x is now NULL. Next"</span>)</a>
<a class="sourceLine" id="cb11-26" data-line-number="26">  app<span class="op">$</span><span class="kw">get_locals</span>()<span class="op">$</span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb11-27" data-line-number="27"></a>
<a class="sourceLine" id="cb11-28" data-line-number="28">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We can set it to a new value, though: x = 65. Next"</span>)</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">  app<span class="op">$</span><span class="kw">get_locals</span>()<span class="op">$</span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="dv">65</span>)</a>
<a class="sourceLine" id="cb11-31" data-line-number="31"></a>
<a class="sourceLine" id="cb11-32" data-line-number="32">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-33" data-line-number="33">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"Now we return to the parent environment. Next"</span>)</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">  app<span class="op">$</span><span class="kw">get_locals</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="st">"parent"</span>,</a>
<a class="sourceLine" id="cb11-35" data-line-number="35">                                         <span class="dt">.results_label =</span> <span class="st">"parent"</span>,</a>
<a class="sourceLine" id="cb11-36" data-line-number="36">                                         <span class="dt">x =</span> <span class="dv">42</span>))</a>
<a class="sourceLine" id="cb11-37" data-line-number="37"></a>
<a class="sourceLine" id="cb11-38" data-line-number="38">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-39" data-line-number="39">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We see that x = 42 again. Next"</span>)</a>
<a class="sourceLine" id="cb11-40" data-line-number="40"></a>
<a class="sourceLine" id="cb11-41" data-line-number="41">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-42" data-line-number="42">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"Now we return to the global environment. Next"</span>)</a>
<a class="sourceLine" id="cb11-43" data-line-number="43">  app<span class="op">$</span><span class="kw">get_locals</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">.module =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb11-44" data-line-number="44">                                         <span class="dt">.results_label =</span> <span class="st">"results"</span>))</a>
<a class="sourceLine" id="cb11-45" data-line-number="45"></a>
<a class="sourceLine" id="cb11-46" data-line-number="46">  app<span class="op">$</span><span class="kw">click_next</span>()</a>
<a class="sourceLine" id="cb11-47" data-line-number="47">  app<span class="op">$</span><span class="kw">expect_ui_text</span>(<span class="st">"We see that x is is NULL again."</span>)</a>
<a class="sourceLine" id="cb11-48" data-line-number="48">  app<span class="op">$</span><span class="kw">get_locals</span>()<span class="op">$</span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb11-49" data-line-number="49"></a>
<a class="sourceLine" id="cb11-50" data-line-number="50">  app<span class="op">$</span><span class="kw"><a href="../reference/get_results.html">get_results</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/equality-expectations.html">expect_equal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb11-51" data-line-number="51">    <span class="dt">parent =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">x =</span> <span class="dv">42</span>),</a>
<a class="sourceLine" id="cb11-52" data-line-number="52">    <span class="dt">parent.child =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">x =</span> <span class="dv">65</span>)</a>
<a class="sourceLine" id="cb11-53" data-line-number="53">  ))</a>
<a class="sourceLine" id="cb11-54" data-line-number="54"></a>
<a class="sourceLine" id="cb11-55" data-line-number="55">  app<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>()</a>
<a class="sourceLine" id="cb11-56" data-line-number="56">})</a></code></pre></div>
</div>
<div id="the-app-code" class="section level3">
<h3 class="hasAnchor">
<a href="#the-app-code" class="anchor"></a>The app code</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(psychTestR)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">elts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join.html">join</a></span>(</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"We begin in the global environment."</span>),</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  <span class="kw"><a href="../reference/module.html">module</a></span>(</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    <span class="st">"parent"</span>,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">    <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"We've now entered the parent environment."</span>),</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">    <span class="kw"><a href="../reference/code_block.html">code_block</a></span>(<span class="cf">function</span>(state, ...) {</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">      x &lt;-<span class="st"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">      <span class="kw"><a href="../reference/global_local.html">set_local</a></span>(<span class="st">"x"</span>, x, state)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">      <span class="kw"><a href="../reference/save_result.html">save_result</a></span>(state, <span class="st">"x"</span>, x)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">    }),</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">    <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"In the parent environment, we define a local variable, x = 42."</span>),</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">    <span class="kw"><a href="../reference/module.html">module</a></span>(</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">      <span class="st">"child"</span>,</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">      <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"Now we enter the child environment."</span>),</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">      <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"We can't see x any more: x is now NULL."</span>),</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">      <span class="kw"><a href="../reference/code_block.html">code_block</a></span>(<span class="cf">function</span>(state, ...) {</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">        x &lt;-<span class="st"> </span><span class="dv">65</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22">        <span class="kw"><a href="../reference/global_local.html">set_local</a></span>(<span class="st">"x"</span>, x, state)</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">        <span class="kw"><a href="../reference/save_result.html">save_result</a></span>(state, <span class="st">"x"</span>, x)</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">      }),</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">      <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"We can set it to a new value, though: x = 65."</span>)</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">    ),</a>
<a class="sourceLine" id="cb12-27" data-line-number="27"></a>
<a class="sourceLine" id="cb12-28" data-line-number="28">    <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"Now we return to the parent environment."</span>),</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">    <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"We see that x = 42 again."</span>)</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">  ),</a>
<a class="sourceLine" id="cb12-31" data-line-number="31"></a>
<a class="sourceLine" id="cb12-32" data-line-number="32">  <span class="kw"><a href="../reference/one_button_page.html">one_button_page</a></span>(<span class="st">"Now we return to the global environment."</span>),</a>
<a class="sourceLine" id="cb12-33" data-line-number="33">  <span class="kw"><a href="../reference/final_page.html">final_page</a></span>(<span class="st">"We see that x is is NULL again."</span>)</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">)</a>
<a class="sourceLine" id="cb12-35" data-line-number="35"></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="kw"><a href="../reference/make_test.html">make_test</a></span>(elts)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#a-real-world-example">A real-world example</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peter M. C. Harrison.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
